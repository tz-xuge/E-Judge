<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.hebut.mapper.UserMapper">

    <resultMap type="com.hebut.entity.User" id="UserMap">
        <result property="uid" column="uid" jdbcType="INTEGER"/>
        <result property="wxopenid" column="wxOpenId" jdbcType="VARCHAR"/>
        <result property="qqopenid" column="qqOpenId" jdbcType="VARCHAR"/>
        <result property="phone" column="phone" jdbcType="VARCHAR"/>
        <result property="email" column="email" jdbcType="VARCHAR"/>
        <result property="name" column="name" jdbcType="VARCHAR"/>
        <result property="sex" column="sex" jdbcType="INTEGER"/>
        <result property="headimg" column="headImg" jdbcType="VARCHAR"/>
        <result property="profile" column="profile" jdbcType="VARCHAR"/>
        <result property="realname" column="realName" jdbcType="VARCHAR"/>
        <result property="address" column="address" jdbcType="VARCHAR"/>
        <result property="idcard" column="idcard" jdbcType="VARCHAR"/>
        <result property="registertime" column="registerTime" jdbcType="TIMESTAMP"/>
        <result property="password" column="password" jdbcType="VARCHAR"/>
        <result property="role" column="role" jdbcType="INTEGER"/>
        <result property="token" column="token" jdbcType="VARCHAR"/>
        <result property="sum" column="sum" javaType="INTEGER"/>
    </resultMap>

	<!--查询单个 用户登录 -->
	<select id="selectByUsername" resultMap="UserMap">
		select
			uid, wxOpenId, qqOpenId, phone, email, name, sex, headImg, profile, realName, address, idcard, registerTime, password, role, token
        from admin
        where (wxOpenId = #{wxopenid})
       	 	or (qqOpenId = #{qqopenid})
       	 	or (token = #{token})
        	or (email = #{email} and password = #{password})
        	or (name = #{name} and password = #{password})
	</select>


    <!--通过主键修改数据-->
    <update id="updateByPrimaryKeySelective">
        update admin
        <set>
            <if test="wxopenid != null and wxopenid != ''">
                wxOpenId = #{wxopenid} ,
            </if>
            <if test="qqopenid != null and qqopenid != ''">
                qqOpenId = #{qqopenid} ,
            </if>
            <if test="phone != null and phone != ''">
                phone = #{phone} ,
            </if>
            <if test="email != null and email != ''">
                email = #{email} ,
            </if>
            <if test="name != null and name != ''">
                name = #{name} ,
            </if>
            <if test="sex != null">
                sex = #{sex} ,
            </if>
            <if test="headimg != null and headimg != ''">
                headImg = #{headimg} ,
            </if>
            <if test="profile != null and profile != ''">
                profile = #{profile} ,
            </if>
            <if test="realname != null and realname != ''">
                realName = #{realname} ,
            </if>
            <if test="address != null and address != ''">
                address = #{address} ,
            </if>
            <if test="idcard != null and idcard != ''">
                idcard = #{idcard} ,
            </if>
            <if test="registertime != null">
                registerTime = #{registertime} ,
            </if>
            <if test="password != null and password != ''">
                password = #{password} ,
            </if>
            <if test="role != null">
                role = #{role} ,
            </if>
            <if test="token != null and token != ''">
                token = #{token} ,
            </if>
            <if test="sum != null and sum != ''">
                sum = #{sum}
            </if>
        </set>
        where uid = #{uid}
    </update>

</mapper>
